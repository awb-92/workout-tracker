<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="color-scheme" content="dark">
  <title>Adam's Health Journey</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            ios: {
              bg: '#000000',
              card: '#1C1C1E',
              secondary: '#2C2C2E',
              blue: '#0A84FF',
              green: '#30D158',
              red: '#FF453A',
              orange: '#FF9F0A',
              purple: '#BF5AF2',
              yellow: '#FFD60A',
              textSecondary: '#8E8E93',
              textTertiary: '#48484A',
              separator: 'rgba(60, 60, 67, 0.36)',
            },
            gray: {
              750: '#2d3748'
            }
          }
        }
      }
    }
  </script>
  <style>
    /* Force dark mode and override Safari extensions */
    :root {
      color-scheme: dark;
      --ios-spring: cubic-bezier(0.36, 0.66, 0.04, 1);
    }
    html, body {
      background-color: #000000 !important;
      color: #ffffff !important;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', system-ui, sans-serif;
      font-size: 17px;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    /* Prevent dark mode extensions from inverting colors */
    * {
      forced-color-adjust: none;
    }
    /* Prevent mobile keyboard zoom */
    input, select, textarea {
      font-size: 17px !important;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', system-ui, sans-serif;
    }
    /* iOS safe areas */
    .safe-area-pad {
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
    }
    .safe-area-bottom {
      padding-bottom: env(safe-area-inset-bottom);
    }
    .safe-area-top {
      padding-top: env(safe-area-inset-top);
    }
    /* Tabular numbers for data displays */
    .tabular-nums {
      font-variant-numeric: tabular-nums;
    }
    /* iOS button tap animation */
    .ios-btn {
      transition: transform 0.1s ease, opacity 0.1s ease;
    }
    .ios-btn:active {
      transform: scale(0.96);
      opacity: 0.7;
    }
    /* iOS card style */
    .ios-card {
      background-color: #1C1C1E;
      border-radius: 16px;
      border: none;
      box-shadow: none;
    }
    /* iOS frosted glass */
    .ios-glass {
      background: rgba(28, 28, 30, 0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
    }
    /* iOS progress bar */
    .ios-progress {
      height: 4px;
      border-radius: 2px;
      overflow: hidden;
    }
    /* iOS separator */
    .ios-separator {
      border-bottom: 1px solid rgba(60, 60, 67, 0.36);
    }
    /* Screen transitions */
    .ios-transition {
      transition: all 0.3s ease-in-out;
    }
    /* Spring animation for completions */
    @keyframes ios-checkmark {
      0% { transform: scale(0.5); opacity: 0; }
      60% { transform: scale(1.15); }
      100% { transform: scale(1); opacity: 1; }
    }
    .ios-check-anim {
      animation: ios-checkmark 0.3s var(--ios-spring) forwards;
    }
    /* Smooth height expansion */
    .ios-expand {
      transition: max-height 0.3s var(--ios-spring), opacity 0.3s ease;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // SVG Icon Components
    const Calendar = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
        <line x1="16" x2="16" y1="2" y2="6"/>
        <line x1="8" x2="8" y1="2" y2="6"/>
        <line x1="3" x2="21" y1="10" y2="10"/>
      </svg>
    );

    const Plus = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M5 12h14"/>
        <path d="M12 5v14"/>
      </svg>
    );

    const TrendingUp = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/>
        <polyline points="16 7 22 7 22 13"/>
      </svg>
    );

    const Target = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"/>
        <circle cx="12" cy="12" r="6"/>
        <circle cx="12" cy="12" r="2"/>
      </svg>
    );

    const Dumbbell = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="m6.5 6.5 11 11"/>
        <path d="m21 21-1-1"/>
        <path d="m3 3 1 1"/>
        <path d="m18 22 4-4"/>
        <path d="m2 6 4-4"/>
        <path d="m3 10 7-7"/>
        <path d="m14 21 7-7"/>
      </svg>
    );

    const Square = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect width="18" height="18" x="3" y="3" rx="2"/>
      </svg>
    );

    const CheckSquare = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect width="18" height="18" x="3" y="3" rx="2"/>
        <path d="m9 12 2 2 4-4"/>
      </svg>
    );

    const Timer = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <line x1="10" x2="14" y1="2" y2="2"/>
        <line x1="12" x2="15" y1="14" y2="11"/>
        <circle cx="12" cy="14" r="8"/>
      </svg>
    );

    const ExternalLink = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
        <polyline points="15 3 21 3 21 9"/>
        <line x1="10" x2="21" y1="14" y2="3"/>
      </svg>
    );

    const FileText = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
        <polyline points="14 2 14 8 20 8"/>
        <line x1="16" x2="8" y1="13" y2="13"/>
        <line x1="16" x2="8" y1="17" y2="17"/>
        <line x1="10" x2="8" y1="9" y2="9"/>
      </svg>
    );

    const BarChart3 = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M3 3v18h18"/>
        <path d="M18 17V9"/>
        <path d="M13 17V5"/>
        <path d="M8 17v-3"/>
      </svg>
    );

    const Check = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="20 6 9 17 4 12"/>
      </svg>
    );

    const Download = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7 10 12 15 17 10"/>
        <line x1="12" x2="12" y1="15" y2="3"/>
      </svg>
    );

    const ChevronRight = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="m9 18 6-6-6-6"/>
      </svg>
    );

    const Bell = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/>
        <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/>
      </svg>
    );

    const ChevronDown = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="m6 9 6 6 6-6"/>
      </svg>
    );

    const ChevronUp = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="m18 15-6-6-6 6"/>
      </svg>
    );

    const Upload = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="17 8 12 3 7 8"/>
        <line x1="12" x2="12" y1="3" y2="15"/>
      </svg>
    );

    const Trash2 = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M3 6h18"/>
        <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
        <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
        <line x1="10" x2="10" y1="11" y2="17"/>
        <line x1="14" x2="14" y1="11" y2="17"/>
      </svg>
    );

    const Footprints = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z"/>
        <path d="M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z"/>
        <path d="M16 17h4"/>
        <path d="M4 13h4"/>
      </svg>
    );

    const Pill = ({ className }) => (
      <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z"/>
        <path d="m8.5 8.5 7 7"/>
      </svg>
    );

    const WorkoutTracker = () => {
      const [currentView, setCurrentView] = useState('home');
      const [workouts, setWorkouts] = useState([]);
      const [activeWorkout, setActiveWorkout] = useState(null);
      const [startWeight] = useState(188);
      const [goalWeight] = useState(155);
      const [currentWeight, setCurrentWeight] = useState(188);
      const [weightEntries, setWeightEntries] = useState([]);
      const [strengthTests, setStrengthTests] = useState([]);
      const [isListening, setIsListening] = useState(false);
      const [restTimer, setRestTimer] = useState(null);
      const [restTimeLeft, setRestTimeLeft] = useState(0);
      const [restType, setRestType] = useState('set');
      const [notes, setNotes] = useState('');
      const [warmupComplete, setWarmupComplete] = useState(false);
      const [warmupExpanded, setWarmupExpanded] = useState(true);
      const [stepsEntries, setStepsEntries] = useState([]);
      const [currentSteps, setCurrentSteps] = useState('');
      const [supplements, setSupplements] = useState({ date: '', vitaminDAM: false, vitaminDPM: false });
      const recognitionRef = useRef(null);
      const restIntervalRef = useRef(null);
      const fileInputRef = useRef(null);

      const baselineStats = {
        pushUps: 16,
        splitSquats: 15,
        plank: 60,
        deepSquat: 60
      };

      const targetStats = {
        pushUps: 30,
        splitSquats: 20,
        plank: 120,
        deepSquat: 180
      };

      const getTodayDateString = () => new Date().toISOString().split('T')[0];

      useEffect(() => {
        const saved = localStorage.getItem('workoutData');
        if (saved) {
          const data = JSON.parse(saved);
          setWorkouts(data.workouts || []);
          setCurrentWeight(data.currentWeight || 188);
          setWeightEntries(data.weightEntries || []);
          setStrengthTests(data.strengthTests || []);
          setNotes(data.notes || '');
          setStepsEntries(data.stepsEntries || []);

          // Load supplements and reset if it's a new day
          const savedSupplements = data.supplements || { date: '', vitaminDAM: false, vitaminDPM: false };
          const today = getTodayDateString();
          if (savedSupplements.date === today) {
            setSupplements(savedSupplements);
          } else {
            setSupplements({ date: today, vitaminDAM: false, vitaminDPM: false });
          }
        } else {
          setCurrentWeight(188);
          setSupplements({ date: getTodayDateString(), vitaminDAM: false, vitaminDPM: false });
        }

        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
          const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
          recognitionRef.current = new SpeechRecognition();
          recognitionRef.current.continuous = false;
          recognitionRef.current.interimResults = false;
          recognitionRef.current.lang = 'en-US';
        }

        return () => {
          if (restIntervalRef.current) clearInterval(restIntervalRef.current);
        };
      }, []);

      useEffect(() => {
        const dataToSave = {
          workouts,
          currentWeight,
          weightEntries,
          strengthTests,
          notes,
          stepsEntries,
          supplements
        };
        localStorage.setItem('workoutData', JSON.stringify(dataToSave));
      }, [workouts, currentWeight, weightEntries, strengthTests, notes, stepsEntries, supplements]);

      const exportData = () => {
        const dataToExport = {
          workouts,
          currentWeight,
          weightEntries,
          strengthTests,
          notes,
          stepsEntries,
          supplements,
          exportDate: new Date().toISOString()
        };
        const dataStr = JSON.stringify(dataToExport, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `workout-data-${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        URL.revokeObjectURL(url);
      };

      const importData = (event) => {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            const importedData = JSON.parse(e.target.result);

            if (!importedData.workouts || !Array.isArray(importedData.workouts)) {
              alert('Invalid backup file format. Please select a valid workout data backup.');
              return;
            }

            const confirmMsg = `This will restore data from ${new Date(importedData.exportDate).toLocaleDateString()}.\n\nCurrent data:\n- ${workouts.length} workouts\n- ${weightEntries.length} weight entries\n\nBackup contains:\n- ${importedData.workouts.length} workouts\n- ${importedData.weightEntries?.length || 0} weight entries\n\nContinue?`;

            if (confirm(confirmMsg)) {
              setWorkouts(importedData.workouts || []);
              setCurrentWeight(importedData.currentWeight || 188);
              setWeightEntries(importedData.weightEntries || []);
              setStrengthTests(importedData.strengthTests || []);
              setNotes(importedData.notes || '');
              setStepsEntries(importedData.stepsEntries || []);
              if (importedData.supplements) {
                const today = getTodayDateString();
                if (importedData.supplements.date === today) {
                  setSupplements(importedData.supplements);
                } else {
                  setSupplements({ date: today, vitaminDAM: false, vitaminDPM: false });
                }
              }

              alert('Data restored successfully!');
            }
          } catch (error) {
            alert('Error reading backup file. Please make sure it\'s a valid JSON file.');
            console.error('Import error:', error);
          }
        };

        reader.readAsText(file);
        event.target.value = '';
      };

      const workoutTemplates = {
        'A': {
          name: 'Workout A - Strength',
          exercises: [
            { name: 'Push-ups', sets: 5, reps: 8, notes: 'Stop at 8 even if you have more', videoUrl: null, isTimeBased: false },
            { name: 'Bodyweight squats', sets: 4, reps: '10-20', notes: '', videoUrl: null, isTimeBased: false },
            { name: 'Floor Y-T-W', sets: 4, reps: '8-12', notes: 'Slow and strict', videoUrl: 'https://www.youtube.com/watch?v=QdGTI4Lshg4', isTimeBased: false },
            { name: 'Dead bug', sets: 3, reps: '8/side', notes: '', videoUrl: 'https://youtube.com/shorts/bsOYjx22OSc?si=K9s6OziBNQtvNzrm', isTimeBased: false },
            { name: 'Side plank', sets: 2, reps: '20-40s/side', notes: '', videoUrl: 'https://youtube.com/shorts/fzLeV8X0Gb8?si=dBJ9Z5uIDyMAlumt', isTimeBased: true }
          ]
        },
        'B': {
          name: 'Workout B - Volume + Legs',
          exercises: [
            { name: 'Incline push-ups', sets: 4, reps: '10-15', notes: 'Pick incline where 10 feels solid', videoUrl: null, isTimeBased: false },
            { name: 'Split squats', sets: 4, reps: '8-12/leg', notes: '1 rep = both legs', videoUrl: 'https://youtube.com/shorts/YuLqw3kHPaw?si=cOEtpu_goBTVfl5r', isTimeBased: false },
            { name: 'Glute bridge', sets: 3, reps: '12-20', notes: '', videoUrl: 'https://youtube.com/shorts/X_IGw8U_e38?si=qfttk2lZ8qSvGvb8', isTimeBased: false },
            { name: 'Hollow/tuck hold', sets: 5, reps: '10-20s', notes: '', videoUrl: 'https://www.youtube.com/shorts/Xk-JcNj6lfY', isTimeBased: true }
          ]
        },
        'A-Progress': {
          name: 'Workout A - Progress Day',
          exercises: [
            { name: 'Push-ups', sets: 4, reps: 9, notes: 'If form breaks, finish on incline', videoUrl: null, isTimeBased: false },
            { name: 'Bodyweight squats', sets: 4, reps: '10-20', notes: '', videoUrl: null, isTimeBased: false },
            { name: 'Floor Y-T-W', sets: 4, reps: '8-12', notes: 'Slow and strict', videoUrl: 'https://www.youtube.com/watch?v=QdGTI4Lshg4', isTimeBased: false },
            { name: 'Dead bug', sets: 3, reps: '8/side', notes: '', videoUrl: 'https://youtube.com/shorts/bsOYjx22OSc?si=K9s6OziBNQtvNzrm', isTimeBased: false },
            { name: 'Side plank', sets: 2, reps: '20-40s/side', notes: '', videoUrl: 'https://youtube.com/shorts/fzLeV8X0Gb8?si=dBJ9Z5uIDyMAlumt', isTimeBased: true }
          ]
        },
        'Strength-Test': {
          name: 'Strength Test (Monthly)',
          exercises: [
            { name: 'Push-ups (max)', sets: 1, reps: 'max', notes: 'To technical failure', videoUrl: null, isTimeBased: false },
            { name: 'Split squats (max/leg)', sets: 1, reps: 'max', notes: 'Each leg to failure', videoUrl: 'https://youtube.com/shorts/YuLqw3kHPaw?si=cOEtpu_goBTVfl5r', isTimeBased: false },
            { name: 'Plank (max time)', sets: 1, reps: 'max', notes: 'Hard-style plank', videoUrl: null, isTimeBased: true },
            { name: 'Deep squat hold (max time)', sets: 1, reps: 'max', notes: 'Heels down if possible', videoUrl: null, isTimeBased: true }
          ]
        }
      };

      const progressPercentage = ((startWeight - currentWeight) / (startWeight - goalWeight)) * 100;
      const completedWorkouts = workouts.filter(w => w.template !== 'Strength-Test').length;
      const targetWorkouts = 72;

      // Steps calculations
      const stepsGoal = 8000;
      const getWeeklyStepsAverage = () => {
        const weekAgo = new Date();
        weekAgo.setDate(weekAgo.getDate() - 7);
        const recentEntries = stepsEntries.filter(e => new Date(e.date) >= weekAgo);
        if (recentEntries.length === 0) return 0;
        const total = recentEntries.reduce((sum, e) => sum + e.steps, 0);
        return Math.round(total / recentEntries.length);
      };
      const weeklyStepsAverage = getWeeklyStepsAverage();
      const stepsProgress = (weeklyStepsAverage / stepsGoal) * 100;

      const getLatestStrengthStats = () => {
        let latestPushUps = baselineStats.pushUps;
        let latestSplitSquats = baselineStats.splitSquats;
        let latestPlank = baselineStats.plank;
        let latestDeepSquat = baselineStats.deepSquat;

        strengthTests.forEach(test => {
          if (test.pushUps) latestPushUps = Math.max(latestPushUps, test.pushUps);
          if (test.splitSquats) latestSplitSquats = Math.max(latestSplitSquats, test.splitSquats);
          if (test.plank) latestPlank = Math.max(latestPlank, test.plank);
          if (test.deepSquat) latestDeepSquat = Math.max(latestDeepSquat, test.deepSquat);
        });

        return { latestPushUps, latestSplitSquats, latestPlank, latestDeepSquat };
      };

      const { latestPushUps, latestSplitSquats, latestPlank, latestDeepSquat } = getLatestStrengthStats();

      const pushUpProgress = ((latestPushUps - baselineStats.pushUps) / (targetStats.pushUps - baselineStats.pushUps)) * 100;
      const splitSquatProgress = ((latestSplitSquats - baselineStats.splitSquats) / (targetStats.splitSquats - baselineStats.splitSquats)) * 100;
      const plankProgress = ((latestPlank - baselineStats.plank) / (targetStats.plank - baselineStats.plank)) * 100;
      const deepSquatProgress = ((latestDeepSquat - baselineStats.deepSquat) / (targetStats.deepSquat - baselineStats.deepSquat)) * 100;

      const strengthProgress = (pushUpProgress + splitSquatProgress + plankProgress + deepSquatProgress) / 4;

      const getRecommendedWorkout = () => {
        const lastWorkout = workouts[0];
        const dayOfWeek = new Date().getDay();

        if (!lastWorkout) {
          if (dayOfWeek === 1 || dayOfWeek === 5) return 'A';
          if (dayOfWeek === 3) return 'B';
          return null;
        }

        const lastTemplate = lastWorkout.template;
        const daysSinceLastWorkout = Math.floor((new Date() - new Date(lastWorkout.date)) / (1000 * 60 * 60 * 24));

        if (daysSinceLastWorkout === 0) return null;

        if (lastTemplate === 'A') return 'B';
        if (lastTemplate === 'B') return 'A-Progress';
        if (lastTemplate === 'A-Progress') return 'A';

        return 'A';
      };

      const needsStrengthTest = () => {
        if (strengthTests.length === 0) return true;
        const lastTest = strengthTests[0];
        const daysSinceTest = Math.floor((new Date() - new Date(lastTest.date)) / (1000 * 60 * 60 * 24));
        return daysSinceTest >= 28;
      };

      const startWorkout = (templateKey) => {
        const template = workoutTemplates[templateKey];
        setActiveWorkout({
          template: templateKey,
          name: template.name,
          startTime: new Date(),
          exercises: template.exercises.map(ex => ({
            ...ex,
            completed: false,
            actualSets: Array(ex.sets).fill().map(() => ({ reps: '', notes: '' }))
          }))
        });
        setWarmupComplete(false);
        setWarmupExpanded(true);
        setCurrentView('workout');
      };

      const updateSet = (exerciseIdx, setIdx, field, value) => {
        setActiveWorkout(prev => {
          const updated = { ...prev };
          updated.exercises[exerciseIdx].actualSets[setIdx][field] = value;
          return updated;
        });

        if (field === 'reps' && value && value !== '') {
          const exercise = activeWorkout.exercises[exerciseIdx];
          const isLastSet = setIdx === exercise.sets - 1;

          if (!isLastSet) {
            setTimeout(() => {
              startRestTimer(90, 'set');
            }, 100);
          } else {
            const allPreviousSetsComplete = exercise.actualSets
              .slice(0, -1)
              .every(set => set.reps && set.reps !== '');

            if (allPreviousSetsComplete) {
              setTimeout(() => {
                toggleExerciseComplete(exerciseIdx);
              }, 200);
            }
          }
        }
      };

      const startRestTimer = (seconds = 90, type = 'set') => {
        if (restIntervalRef.current) clearInterval(restIntervalRef.current);

        setRestTimer(seconds);
        setRestTimeLeft(seconds);
        setRestType(type);

        const halfwayPoint = Math.floor(seconds / 2);

        restIntervalRef.current = setInterval(() => {
          setRestTimeLeft(prev => {
            if (prev === halfwayPoint) {
              if (navigator.vibrate) navigator.vibrate(100);
            }

            if (prev <= 1) {
              clearInterval(restIntervalRef.current);
              setRestTimer(null);
              if (navigator.vibrate) navigator.vibrate([200, 100, 200]);
              return 0;
            }
            return prev - 1;
          });
        }, 1000);
      };

      const cancelRestTimer = () => {
        if (restIntervalRef.current) clearInterval(restIntervalRef.current);
        setRestTimer(null);
        setRestTimeLeft(0);
        setRestType('set');
      };

      const toggleExerciseComplete = (exerciseIdx) => {
        setActiveWorkout(prev => {
          const updated = { ...prev };
          updated.exercises[exerciseIdx].completed = !updated.exercises[exerciseIdx].completed;
          return updated;
        });

        const justCompleted = !activeWorkout.exercises[exerciseIdx].completed;
        const hasNextExercise = exerciseIdx < activeWorkout.exercises.length - 1;

        if (justCompleted && hasNextExercise) {
          setTimeout(() => {
            startRestTimer(120, 'exercise');
          }, 100);
        }

        setTimeout(() => {
          const nextIncomplete = activeWorkout.exercises.findIndex((ex, idx) => idx > exerciseIdx && !ex.completed);
          if (nextIncomplete !== -1) {
            const element = document.getElementById(`exercise-${nextIncomplete}`);
            if (element) {
              element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
          }
        }, 300);
      };

      const finishWorkout = () => {
        const completed = {
          ...activeWorkout,
          endTime: new Date(),
          date: new Date().toISOString()
        };

        const updatedWorkouts = [completed, ...workouts];
        setWorkouts(updatedWorkouts);

        if (completed.template === 'Strength-Test') {
          const testResults = {
            date: new Date().toISOString(),
            pushUps: parseInt(completed.exercises[0]?.actualSets[0]?.reps) || 0,
            splitSquats: parseInt(completed.exercises[1]?.actualSets[0]?.reps) || 0,
            plank: parseInt(completed.exercises[2]?.actualSets[0]?.reps) || 0,
            deepSquat: parseInt(completed.exercises[3]?.actualSets[0]?.reps) || 0
          };
          setStrengthTests([testResults, ...strengthTests]);
        }

        exportData();

        setActiveWorkout(null);
        setWarmupComplete(false);
        setCurrentView('home');
      };

      const submitWeight = () => {
        const newEntry = {
          date: new Date().toISOString(),
          weight: currentWeight
        };
        setWeightEntries([newEntry, ...weightEntries]);
      };

      const adjustWeight = (delta) => {
        setCurrentWeight(prev => Math.max(100, Math.min(300, prev + delta)));
      };

      const deleteWorkout = (idx, e) => {
        e.stopPropagation();
        if (confirm('Are you sure you want to delete this workout?')) {
          const updatedWorkouts = workouts.filter((_, i) => i !== idx);
          setWorkouts(updatedWorkouts);
        }
      };

      const submitSteps = () => {
        const steps = parseInt(currentSteps);
        if (isNaN(steps) || steps < 0) return;
        const newEntry = {
          date: new Date().toISOString(),
          steps: steps
        };
        setStepsEntries([newEntry, ...stepsEntries]);
        setCurrentSteps('');
      };

      const toggleSupplement = (type) => {
        const today = getTodayDateString();
        setSupplements(prev => ({
          ...prev,
          date: today,
          [type]: !prev[type]
        }));
      };

      if (currentView === 'workout' && activeWorkout) {
        const currentExerciseIndex = activeWorkout.exercises.findIndex(ex => !ex.completed);
        const allCompleted = currentExerciseIndex === -1;

        return (
          <div className="min-h-screen pb-32 safe-area-pad" style={{ backgroundColor: '#000' }}>
            <div className="ios-glass text-white sticky top-0 z-10 safe-area-top" style={{ padding: '12px 16px' }}>
              <div className="flex justify-between items-center mb-3">
                <h2 className="text-lg font-semibold" style={{ letterSpacing: '-0.3px' }}>{activeWorkout.name}</h2>
                <span className="text-sm tabular-nums" style={{ color: '#8E8E93' }}>
                  {Math.floor((new Date() - activeWorkout.startTime) / 60000)} min
                </span>
              </div>

              {restTimer !== null && (
                <div className="mb-3" style={{ backgroundColor: '#2C2C2E', borderRadius: '12px', padding: '12px' }}>
                  <div className="flex justify-between items-center mb-2">
                    <span className="text-sm font-semibold">
                      {restType === 'exercise' ? 'Transition break' : 'Rest period'}
                    </span>
                    <div className="flex items-center gap-2">
                      <span className="text-xl font-bold tabular-nums" style={{ color: '#0A84FF' }}>
                        {Math.floor(restTimeLeft / 60)}:{(restTimeLeft % 60).toString().padStart(2, '0')}
                      </span>
                      <button
                        onClick={() => {
                          const newTime = restTimeLeft + 30;
                          setRestTimer(restTimer + 30);
                          setRestTimeLeft(newTime);
                        }}
                        className="ios-btn"
                        style={{ padding: '6px 10px', backgroundColor: '#30D158', borderRadius: '8px', fontSize: '13px', fontWeight: 600 }}
                      >
                        +30s
                      </button>
                      <button
                        onClick={cancelRestTimer}
                        className="ios-btn"
                        style={{ padding: '6px 12px', backgroundColor: '#2C2C2E', border: '1px solid rgba(60,60,67,0.36)', borderRadius: '8px', fontSize: '13px', fontWeight: 600, color: '#8E8E93' }}
                      >
                        Skip
                      </button>
                    </div>
                  </div>
                  <div className="ios-progress" style={{ backgroundColor: '#48484A' }}>
                    <div
                      style={{
                        backgroundColor: '#0A84FF',
                        height: '4px',
                        borderRadius: '2px',
                        width: `${100 - (restTimeLeft / restTimer * 100)}%`,
                        transition: 'width 1s linear'
                      }}
                    />
                  </div>
                </div>
              )}

              <div className="mb-3">
                <div className="text-center text-xs mb-2" style={{ color: '#8E8E93' }}>
                  Manual rest timers
                </div>
                <div className="flex gap-2">
                  <button
                    onClick={() => startRestTimer(60, 'set')}
                    className="ios-btn flex-1 text-white font-semibold text-sm"
                    style={{ padding: '8px', backgroundColor: '#2C2C2E', borderRadius: '10px' }}
                  >
                    60s
                  </button>
                  <button
                    onClick={() => startRestTimer(90, 'set')}
                    className="ios-btn flex-1 text-white font-semibold text-sm"
                    style={{ padding: '8px', backgroundColor: '#0A84FF', borderRadius: '10px' }}
                  >
                    90s
                  </button>
                  <button
                    onClick={() => startRestTimer(120, 'set')}
                    className="ios-btn flex-1 text-white font-semibold text-sm"
                    style={{ padding: '8px', backgroundColor: '#2C2C2E', borderRadius: '10px' }}
                  >
                    2m
                  </button>
                </div>
              </div>

              <div className="ios-progress mb-3" style={{ backgroundColor: '#48484A' }}>
                <div
                  style={{
                    backgroundColor: '#30D158',
                    height: '4px',
                    borderRadius: '2px',
                    width: `${(activeWorkout.exercises.filter(e => e.completed).length / activeWorkout.exercises.length) * 100}%`,
                    transition: 'width 0.3s var(--ios-spring)'
                  }}
                />
              </div>

              <div style={{ backgroundColor: '#2C2C2E', borderRadius: '10px', padding: '10px 12px' }}>
                <p className="text-xs" style={{ color: '#8E8E93' }}>Complete all sets of one exercise before moving to the next. Rest 60-90s between sets, 2-3 min between exercises.</p>
              </div>
            </div>

            <div style={{ padding: '16px', display: 'flex', flexDirection: 'column', gap: '12px' }}>
              {!warmupComplete && (
                <div className="ios-card" style={{ padding: '16px', position: 'relative' }}>
                  <div style={{ position: 'absolute', top: '12px', right: '12px', width: '8px', height: '8px', borderRadius: '4px', backgroundColor: '#FF9F0A' }} />
                  <div className="flex items-center justify-between mb-3">
                    <div className="flex items-center gap-2">
                      <h3 className="font-semibold" style={{ fontSize: '17px', color: '#FF9F0A' }}>Warm-up (6-8 min)</h3>
                      <button
                        onClick={() => setWarmupExpanded(!warmupExpanded)}
                        className="ios-btn"
                        style={{ color: '#FF9F0A' }}
                      >
                        {warmupExpanded ? <ChevronUp className="w-5 h-5" /> : <ChevronDown className="w-5 h-5" />}
                      </button>
                    </div>
                    <button
                      onClick={() => setWarmupComplete(true)}
                      className="ios-btn"
                      style={{ padding: '8px 16px', backgroundColor: '#FF9F0A', borderRadius: '12px', fontWeight: 600, fontSize: '15px', color: '#000' }}
                    >
                      Complete
                    </button>
                  </div>

                  {warmupExpanded && (
                    <div className="space-y-2 text-sm" style={{ color: '#8E8E93' }}>
                      <p>1 min brisk march or jumping jacks</p>
                      <p className="font-semibold" style={{ color: '#fff' }}>2 rounds of:</p>
                      <p className="ml-4">8 hip hinges</p>
                      <p className="ml-4">8 squat-to-stand</p>
                      <p className="ml-4">10 scapular push-ups (small range)</p>
                      <p className="ml-4">20-30s plank</p>
                      <div className="flex gap-2 mt-3">
                        <button
                          onClick={() => startRestTimer(480, 'set')}
                          className="ios-btn flex-1 text-white font-semibold text-sm"
                          style={{ padding: '10px', backgroundColor: '#FF9F0A', borderRadius: '12px', color: '#000' }}
                        >
                          Start 8 min timer
                        </button>
                      </div>
                    </div>
                  )}
                </div>
              )}

              {activeWorkout.exercises.map((exercise, exIdx) => {
                const isCurrentExercise = exIdx === currentExerciseIndex;
                const isPastExercise = exercise.completed;
                const isFutureExercise = !isCurrentExercise && !isPastExercise;

                return (
                  <div
                    key={exIdx}
                    id={`exercise-${exIdx}`}
                    className="ios-card ios-transition"
                    style={{
                      padding: '16px',
                      position: 'relative',
                      opacity: isFutureExercise ? 0.5 : 1,
                    }}
                  >
                    {/* Status dot */}
                    <div style={{
                      position: 'absolute', top: '12px', right: '12px',
                      width: '8px', height: '8px', borderRadius: '4px',
                      backgroundColor: isPastExercise ? '#30D158' : isCurrentExercise ? '#0A84FF' : '#48484A'
                    }} />

                    <div className="flex items-start justify-between mb-3">
                      <div className="flex-1">
                        <div className="flex items-center gap-2">
                          <span className="text-sm font-semibold tabular-nums" style={{ color: '#48484A' }}>#{exIdx + 1}</span>
                          <button
                            onClick={() => toggleExerciseComplete(exIdx)}
                            className="flex-shrink-0 ios-btn"
                          >
                            {exercise.completed ? (
                              <CheckSquare className="w-6 h-6 ios-check-anim" style={{ color: '#30D158' }} />
                            ) : (
                              <Square className="w-6 h-6" style={{ color: '#48484A' }} />
                            )}
                          </button>
                          <h3 className="font-semibold" style={{
                            fontSize: '17px',
                            color: exercise.completed ? '#48484A' : '#fff',
                            textDecoration: exercise.completed ? 'line-through' : 'none'
                          }}>
                            {exercise.name}
                          </h3>
                          {exercise.videoUrl && (
                            <a
                              href={exercise.videoUrl}
                              target="_blank"
                              rel="noopener noreferrer"
                              className="ios-btn ml-1"
                              title="Watch form video"
                              style={{ color: '#0A84FF' }}
                              onClick={(e) => {
                                e.preventDefault();
                                window.open(exercise.videoUrl, '_blank', 'noopener,noreferrer');
                              }}
                            >
                              <ExternalLink className="w-4 h-4" />
                            </a>
                          )}
                        </div>
                        {isCurrentExercise && (
                          <div className="mt-1 text-xs font-semibold" style={{ color: '#0A84FF' }}>
                            Current exercise
                          </div>
                        )}
                        <p className="text-sm tabular-nums" style={{ color: '#8E8E93', marginTop: '2px' }}>
                          Target: {exercise.sets} x {exercise.reps}
                        </p>
                        {exercise.notes && (
                          <p className="text-xs mt-1" style={{ color: '#0A84FF' }}>{exercise.notes}</p>
                        )}
                      </div>
                    </div>

                    <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                      {exercise.actualSets.map((set, setIdx) => (
                        <div key={setIdx} className="flex gap-2 items-center">
                          <span className="text-sm font-medium tabular-nums w-10 flex-shrink-0" style={{ color: '#8E8E93' }}>Set {setIdx + 1}</span>
                          {exercise.isTimeBased ? (
                            <select
                              value={set.reps}
                              onChange={(e) => updateSet(exIdx, setIdx, 'reps', e.target.value)}
                              className="w-24 flex-shrink-0 text-center text-lg font-semibold text-white tabular-nums"
                              style={{ backgroundColor: '#2C2C2E', border: 'none', borderRadius: '10px', padding: '11px 16px' }}
                              disabled={isFutureExercise}
                            >
                              <option value="">-</option>
                              {Array.from({length: 120}, (_, i) => i + 1).map(seconds => {
                                const mins = Math.floor(seconds / 60);
                                const secs = seconds % 60;
                                const display = mins > 0 ? `${mins}:${secs.toString().padStart(2, '0')}` : `0:${secs.toString().padStart(2, '0')}`;
                                return (
                                  <option key={seconds} value={seconds}>{display}</option>
                                );
                              })}
                            </select>
                          ) : (
                            <select
                              value={set.reps}
                              onChange={(e) => updateSet(exIdx, setIdx, 'reps', e.target.value)}
                              className="w-20 flex-shrink-0 text-center text-lg font-semibold text-white tabular-nums"
                              style={{ backgroundColor: '#2C2C2E', border: 'none', borderRadius: '10px', padding: '11px 16px' }}
                              disabled={isFutureExercise}
                            >
                              <option value="">-</option>
                              {Array.from({length: 50}, (_, i) => i + 1).map(num => (
                                <option key={num} value={num}>{num}</option>
                              ))}
                            </select>
                          )}
                          <input
                            type="text"
                            placeholder="notes"
                            value={set.notes}
                            onChange={(e) => updateSet(exIdx, setIdx, 'notes', e.target.value)}
                            className="flex-1 min-w-0 text-sm text-white"
                            style={{ backgroundColor: '#2C2C2E', border: 'none', borderRadius: '10px', padding: '11px 16px' }}
                            disabled={isFutureExercise}
                          />
                        </div>
                      ))}
                    </div>

                    {exercise.completed && exIdx < activeWorkout.exercises.length - 1 && (
                      <div className="mt-3" style={{ backgroundColor: '#000', borderRadius: '10px', padding: '10px 12px' }}>
                        <p className="text-xs text-center" style={{ color: '#8E8E93' }}>
                          Transition timer started (2 min). Use +30s if needed.
                        </p>
                      </div>
                    )}
                  </div>
                );
              })}
            </div>

            <div className="fixed bottom-0 left-0 right-0 ios-glass safe-area-bottom" style={{ padding: '12px 16px', borderTop: '1px solid rgba(60,60,67,0.36)' }}>
              <div className="flex gap-3">
                <button
                  onClick={() => {
                    setActiveWorkout(null);
                    setCurrentView('home');
                    cancelRestTimer();
                  }}
                  className="ios-btn flex-1 font-semibold"
                  style={{ padding: '14px', backgroundColor: '#2C2C2E', borderRadius: '12px', color: '#8E8E93', minHeight: '44px' }}
                >
                  Cancel
                </button>
                <button
                  onClick={() => {
                    finishWorkout();
                    cancelRestTimer();
                  }}
                  className="ios-btn flex-1 font-semibold"
                  style={{ padding: '14px', backgroundColor: '#30D158', borderRadius: '12px', color: '#fff', minHeight: '44px' }}
                >
                  Finish workout
                </button>
              </div>
            </div>
          </div>
        );
      }

      if (currentView === 'weightChart') {
        const sortedEntries = [...weightEntries].sort((a, b) => new Date(a.date) - new Date(b.date));

        return (
          <div className="min-h-screen safe-area-pad" style={{ backgroundColor: '#000' }}>
            <div className="ios-glass safe-area-top" style={{ padding: '12px 16px' }}>
              <button onClick={() => setCurrentView('home')} className="ios-btn mb-2 text-sm font-semibold" style={{ color: '#0A84FF' }}>
                <span style={{ marginRight: '4px' }}>&lsaquo;</span> Back
              </button>
              <h2 style={{ fontSize: '34px', fontWeight: 700, letterSpacing: '0.4px' }}>Weight</h2>
            </div>

            <div style={{ padding: '16px' }}>
              {weightEntries.length === 0 ? (
                <div className="text-center" style={{ padding: '60px 0' }}>
                  <TrendingUp className="mx-auto mb-3" style={{ width: '60px', height: '60px', color: '#48484A' }} />
                  <p style={{ fontSize: '17px', color: '#8E8E93' }}>No weight entries yet</p>
                  <p className="text-sm mt-1" style={{ color: '#48484A' }}>Log your first weigh-in to get started</p>
                </div>
              ) : (
                <>
                  <div className="ios-card" style={{ padding: '16px', marginBottom: '12px' }}>
                    <div className="flex justify-between text-xs mb-2" style={{ color: '#8E8E93' }}>
                      <span className="tabular-nums">Start: {startWeight} lb</span>
                      <span className="tabular-nums">Goal: {goalWeight} lb</span>
                    </div>
                    <div className="relative h-48" style={{ backgroundColor: '#2C2C2E', borderRadius: '10px' }}>
                      {sortedEntries.map((entry, idx) => {
                        const percentage = ((entry.weight - goalWeight) / (startWeight - goalWeight)) * 100;
                        const leftPosition = (idx / (sortedEntries.length - 1 || 1)) * 100;
                        return (
                          <div
                            key={idx}
                            className="absolute w-2 rounded-full"
                            style={{
                              backgroundColor: '#30D158',
                              bottom: `${100 - Math.min(Math.max(percentage, 0), 100)}%`,
                              left: `${leftPosition}%`,
                              height: '8px',
                              transform: 'translateX(-50%)'
                            }}
                            title={`${entry.weight} lb - ${new Date(entry.date).toLocaleDateString()}`}
                          />
                        );
                      })}
                      {sortedEntries.length > 1 && sortedEntries.map((entry, idx) => {
                        if (idx === 0) return null;
                        const prevEntry = sortedEntries[idx - 1];
                        const percentage = ((entry.weight - goalWeight) / (startWeight - goalWeight)) * 100;
                        const prevPercentage = ((prevEntry.weight - goalWeight) / (startWeight - goalWeight)) * 100;
                        const leftPosition = (idx / (sortedEntries.length - 1)) * 100;
                        const prevLeftPosition = ((idx - 1) / (sortedEntries.length - 1)) * 100;

                        return (
                          <svg
                            key={`line-${idx}`}
                            className="absolute inset-0 w-full h-full pointer-events-none"
                            style={{ overflow: 'visible' }}
                          >
                            <line
                              x1={`${prevLeftPosition}%`}
                              y1={`${100 - Math.min(Math.max(prevPercentage, 0), 100)}%`}
                              x2={`${leftPosition}%`}
                              y2={`${100 - Math.min(Math.max(percentage, 0), 100)}%`}
                              stroke="#30D158"
                              strokeWidth="2"
                            />
                          </svg>
                        );
                      })}
                    </div>
                  </div>

                  <div>
                    <h3 className="text-sm font-semibold mb-2" style={{ color: '#8E8E93', padding: '0 4px' }}>History</h3>
                    <div className="ios-card" style={{ overflow: 'hidden' }}>
                      {weightEntries.map((entry, idx) => {
                        const prevWeight = idx < weightEntries.length - 1 ? weightEntries[idx + 1].weight : startWeight;
                        const change = entry.weight - prevWeight;

                        return (
                          <div key={idx} className="flex justify-between items-center" style={{
                            padding: '12px 16px',
                            borderBottom: idx < weightEntries.length - 1 ? '1px solid rgba(60,60,67,0.36)' : 'none',
                            minHeight: '44px'
                          }}>
                            <div>
                              <p className="text-white font-semibold tabular-nums">{entry.weight} lb</p>
                              <p className="text-xs" style={{ color: '#8E8E93' }}>{new Date(entry.date).toLocaleDateString()}</p>
                            </div>
                            {change !== 0 && (
                              <div className="text-sm font-semibold tabular-nums" style={{ color: change < 0 ? '#30D158' : '#FF453A' }}>
                                {change > 0 ? '+' : ''}{change.toFixed(1)} lb
                              </div>
                            )}
                          </div>
                        );
                      })}
                    </div>
                  </div>
                </>
              )}
            </div>
          </div>
        );
      }

      if (currentView === 'stepsChart') {
        const sortedEntries = [...stepsEntries].sort((a, b) => new Date(a.date) - new Date(b.date));
        const maxSteps = Math.max(stepsGoal, ...sortedEntries.map(e => e.steps));

        return (
          <div className="min-h-screen safe-area-pad" style={{ backgroundColor: '#000' }}>
            <div className="ios-glass safe-area-top" style={{ padding: '12px 16px' }}>
              <button onClick={() => setCurrentView('home')} className="ios-btn mb-2 text-sm font-semibold" style={{ color: '#0A84FF' }}>
                <span style={{ marginRight: '4px' }}>&lsaquo;</span> Back
              </button>
              <h2 style={{ fontSize: '34px', fontWeight: 700, letterSpacing: '0.4px' }}>Steps</h2>
            </div>

            <div style={{ padding: '16px' }}>
              {stepsEntries.length === 0 ? (
                <div className="text-center" style={{ padding: '60px 0' }}>
                  <Footprints className="mx-auto mb-3" style={{ width: '60px', height: '60px', color: '#48484A' }} />
                  <p style={{ fontSize: '17px', color: '#8E8E93' }}>No steps entries yet</p>
                  <p className="text-sm mt-1" style={{ color: '#48484A' }}>Log your first entry to get started</p>
                </div>
              ) : (
                <>
                  <div className="ios-card" style={{ padding: '16px', marginBottom: '12px' }}>
                    <div className="flex justify-between text-xs mb-2" style={{ color: '#8E8E93' }}>
                      <span className="tabular-nums">0 steps</span>
                      <span className="tabular-nums">Goal: {stepsGoal.toLocaleString()}</span>
                    </div>
                    <div className="relative h-48" style={{ backgroundColor: '#2C2C2E', borderRadius: '10px' }}>
                      <div
                        className="absolute w-full"
                        style={{ bottom: `${(stepsGoal / maxSteps) * 100}%`, borderTop: '2px dashed rgba(48,209,88,0.4)' }}
                      >
                        <span className="absolute right-1 text-xs" style={{ top: '-16px', color: '#30D158' }}>8k goal</span>
                      </div>
                      {sortedEntries.map((entry, idx) => {
                        const percentage = (entry.steps / maxSteps) * 100;
                        const leftPosition = (idx / (sortedEntries.length - 1 || 1)) * 100;
                        const meetsGoal = entry.steps >= stepsGoal;
                        return (
                          <div
                            key={idx}
                            className="absolute w-2 rounded-full"
                            style={{
                              backgroundColor: meetsGoal ? '#30D158' : '#FF9F0A',
                              bottom: `${Math.min(percentage, 100)}%`,
                              left: `${leftPosition}%`,
                              height: '8px',
                              transform: 'translateX(-50%)'
                            }}
                            title={`${entry.steps.toLocaleString()} steps - ${new Date(entry.date).toLocaleDateString()}`}
                          />
                        );
                      })}
                      {sortedEntries.length > 1 && sortedEntries.map((entry, idx) => {
                        if (idx === 0) return null;
                        const prevEntry = sortedEntries[idx - 1];
                        const percentage = (entry.steps / maxSteps) * 100;
                        const prevPercentage = (prevEntry.steps / maxSteps) * 100;
                        const leftPosition = (idx / (sortedEntries.length - 1)) * 100;
                        const prevLeftPosition = ((idx - 1) / (sortedEntries.length - 1)) * 100;

                        return (
                          <svg
                            key={`line-${idx}`}
                            className="absolute inset-0 w-full h-full pointer-events-none"
                            style={{ overflow: 'visible' }}
                          >
                            <line
                              x1={`${prevLeftPosition}%`}
                              y1={`${100 - Math.min(prevPercentage, 100)}%`}
                              x2={`${leftPosition}%`}
                              y2={`${100 - Math.min(percentage, 100)}%`}
                              stroke="#FF9F0A"
                              strokeWidth="2"
                            />
                          </svg>
                        );
                      })}
                    </div>
                    <div className="mt-3 text-center">
                      <span className="text-sm" style={{ color: '#8E8E93' }}>Weekly average: </span>
                      <span className="text-lg font-bold tabular-nums" style={{ color: weeklyStepsAverage >= stepsGoal ? '#30D158' : '#FF9F0A' }}>
                        {weeklyStepsAverage.toLocaleString()} steps
                      </span>
                    </div>
                  </div>

                  <div>
                    <h3 className="text-sm font-semibold mb-2" style={{ color: '#8E8E93', padding: '0 4px' }}>History</h3>
                    <div className="ios-card" style={{ overflow: 'hidden' }}>
                      {stepsEntries.map((entry, idx) => {
                        const meetsGoal = entry.steps >= stepsGoal;
                        return (
                          <div key={idx} className="flex justify-between items-center" style={{
                            padding: '12px 16px',
                            borderBottom: idx < stepsEntries.length - 1 ? '1px solid rgba(60,60,67,0.36)' : 'none',
                            minHeight: '44px'
                          }}>
                            <div>
                              <p className="font-semibold tabular-nums" style={{ color: meetsGoal ? '#30D158' : '#fff' }}>
                                {entry.steps.toLocaleString()} steps
                              </p>
                              <p className="text-xs" style={{ color: '#8E8E93' }}>{new Date(entry.date).toLocaleDateString()}</p>
                            </div>
                            {meetsGoal && (
                              <Check className="w-5 h-5" style={{ color: '#30D158' }} />
                            )}
                          </div>
                        );
                      })}
                    </div>
                  </div>
                </>
              )}
            </div>
          </div>
        );
      }

      if (currentView === 'notes') {
        return (
          <div className="min-h-screen safe-area-pad" style={{ backgroundColor: '#000' }}>
            <div className="ios-glass safe-area-top" style={{ padding: '12px 16px' }}>
              <button onClick={() => setCurrentView('home')} className="ios-btn mb-2 text-sm font-semibold" style={{ color: '#0A84FF' }}>
                <span style={{ marginRight: '4px' }}>&lsaquo;</span> Back
              </button>
              <h2 style={{ fontSize: '34px', fontWeight: 700, letterSpacing: '0.4px' }}>Notes</h2>
            </div>

            <div style={{ padding: '16px' }}>
              <textarea
                value={notes}
                onChange={(e) => setNotes(e.target.value)}
                placeholder="Add workout links, nutrition info, progress notes..."
                className="w-full text-white text-sm"
                style={{
                  height: '384px',
                  backgroundColor: '#1C1C1E',
                  border: 'none',
                  borderRadius: '16px',
                  padding: '16px',
                  resize: 'none',
                  outline: 'none'
                }}
                onFocus={(e) => e.target.style.boxShadow = '0 0 0 2px #0A84FF'}
                onBlur={(e) => e.target.style.boxShadow = 'none'}
              />
              <p className="text-xs mt-2" style={{ color: '#48484A' }}>Auto-saved</p>
            </div>
          </div>
        );
      }

      if (currentView === 'history') {
        return (
          <div className="min-h-screen safe-area-pad" style={{ backgroundColor: '#000' }}>
            <div className="ios-glass safe-area-top" style={{ padding: '12px 16px' }}>
              <button onClick={() => setCurrentView('home')} className="ios-btn mb-2 text-sm font-semibold" style={{ color: '#0A84FF' }}>
                <span style={{ marginRight: '4px' }}>&lsaquo;</span> Back
              </button>
              <h2 style={{ fontSize: '34px', fontWeight: 700, letterSpacing: '0.4px' }}>History</h2>
            </div>

            <div style={{ padding: '16px' }}>
              {workouts.length === 0 ? (
                <div className="text-center" style={{ padding: '60px 0' }}>
                  <Dumbbell className="mx-auto mb-3" style={{ width: '60px', height: '60px', color: '#48484A' }} />
                  <p style={{ fontSize: '17px', color: '#8E8E93' }}>No workouts yet</p>
                  <p className="text-sm mt-1" style={{ color: '#48484A' }}>Complete your first workout to see it here</p>
                </div>
              ) : (
                <div className="ios-card" style={{ overflow: 'hidden' }}>
                  {workouts.map((workout, idx) => (
                    <div
                      key={idx}
                      className="relative"
                      style={{
                        borderBottom: idx < workouts.length - 1 ? '1px solid rgba(60,60,67,0.36)' : 'none',
                      }}
                    >
                      <button
                        onClick={() => setCurrentView(`workout-detail-${idx}`)}
                        className="w-full text-left ios-btn"
                        style={{ padding: '12px 16px', paddingRight: '48px', minHeight: '44px' }}
                      >
                        <div className="flex justify-between items-start mb-1">
                          <h3 className="font-semibold text-white" style={{ fontSize: '17px' }}>{workout.name}</h3>
                          <div className="text-right">
                            <p className="text-sm" style={{ color: '#8E8E93' }}>
                              {new Date(workout.date).toLocaleDateString()}
                            </p>
                          </div>
                        </div>
                        <div className="flex items-center gap-3">
                          <p className="text-sm tabular-nums" style={{ color: '#8E8E93' }}>
                            {Math.floor((new Date(workout.endTime) - new Date(workout.startTime)) / 60000)} min
                          </p>
                          <p className="text-xs tabular-nums" style={{ color: '#48484A' }}>
                            {workout.exercises.filter(e => e.completed).length}/{workout.exercises.length} exercises
                          </p>
                        </div>
                      </button>
                      <button
                        onClick={(e) => deleteWorkout(idx, e)}
                        className="absolute top-3 right-3 ios-btn"
                        style={{ padding: '8px', color: '#FF453A', borderRadius: '8px' }}
                        title="Delete workout"
                      >
                        <Trash2 className="w-5 h-5" />
                      </button>
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>
        );
      }

      if (currentView.startsWith('workout-detail-')) {
        const workoutIndex = parseInt(currentView.split('-')[2]);
        const workout = workouts[workoutIndex];

        return (
          <div className="min-h-screen safe-area-pad" style={{ backgroundColor: '#000' }}>
            <div className="ios-glass safe-area-top" style={{ padding: '12px 16px' }}>
              <button onClick={() => setCurrentView('history')} className="ios-btn mb-2 text-sm font-semibold" style={{ color: '#0A84FF' }}>
                <span style={{ marginRight: '4px' }}>&lsaquo;</span> Back
              </button>
              <h2 className="font-bold" style={{ fontSize: '22px', fontWeight: 700, letterSpacing: '-0.3px' }}>{workout.name}</h2>
              <div className="flex gap-4 text-sm mt-1 tabular-nums" style={{ color: '#8E8E93' }}>
                <span>{new Date(workout.date).toLocaleDateString()}</span>
                <span>{new Date(workout.date).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</span>
                <span>{Math.floor((new Date(workout.endTime) - new Date(workout.startTime)) / 60000)} min</span>
              </div>
            </div>

            <div style={{ padding: '16px', display: 'flex', flexDirection: 'column', gap: '12px' }}>
              {workout.exercises.map((exercise, exIdx) => (
                <div
                  key={exIdx}
                  className="ios-card"
                  style={{ padding: '16px', position: 'relative' }}
                >
                  <div style={{
                    position: 'absolute', top: '12px', right: '12px',
                    width: '8px', height: '8px', borderRadius: '4px',
                    backgroundColor: exercise.completed ? '#30D158' : '#48484A'
                  }} />

                  <div className="flex items-center gap-2 mb-3">
                    {exercise.completed ? (
                      <CheckSquare className="w-5 h-5" style={{ color: '#30D158' }} />
                    ) : (
                      <Square className="w-5 h-5" style={{ color: '#48484A' }} />
                    )}
                    <h3 className="font-semibold text-white" style={{ fontSize: '17px' }}>
                      {exercise.name}
                    </h3>
                  </div>

                  <p className="text-sm mb-2 tabular-nums" style={{ color: '#8E8E93' }}>
                    Target: {exercise.sets} x {exercise.reps}
                  </p>

                  <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>
                    {exercise.actualSets.map((set, setIdx) => {
                      let displayValue = set.reps || '-';
                      if (exercise.isTimeBased && set.reps) {
                        const totalSeconds = parseInt(set.reps);
                        if (!isNaN(totalSeconds)) {
                          const mins = Math.floor(totalSeconds / 60);
                          const secs = totalSeconds % 60;
                          displayValue = `${mins}:${secs.toString().padStart(2, '0')}`;
                        }
                      }

                      return (
                        <div key={setIdx} className="flex items-center gap-2 text-sm" style={{
                          padding: '6px 0',
                          borderBottom: setIdx < exercise.actualSets.length - 1 ? '1px solid rgba(60,60,67,0.18)' : 'none'
                        }}>
                          <span className="w-16 tabular-nums" style={{ color: '#48484A' }}>Set {setIdx + 1}:</span>
                          <span className="text-white font-semibold tabular-nums">
                            {displayValue} {exercise.isTimeBased ? '' : 'reps'}
                          </span>
                          {set.notes && (
                            <span className="text-xs ml-2" style={{ color: '#8E8E93' }}>({set.notes})</span>
                          )}
                        </div>
                      );
                    })}
                  </div>
                </div>
              ))}
            </div>
          </div>
        );
      }

      const recommendedWorkout = getRecommendedWorkout();
      const needsTest = needsStrengthTest();

      return (
        <div className="min-h-screen safe-area-pad" style={{ backgroundColor: '#000' }}>
          <div className="safe-area-top" style={{ padding: '16px 16px 12px' }}>
            <h1 style={{ fontSize: '34px', fontWeight: 700, letterSpacing: '0.4px', marginBottom: '16px', color: '#fff' }}>Health Journey</h1>
            <div className="ios-card" style={{ padding: '16px' }}>
              <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                <div>
                  <div className="flex justify-between text-xs mb-1" style={{ color: '#8E8E93' }}>
                    <span>Weight</span>
                    <span className="tabular-nums">{currentWeight}  {goalWeight} lb</span>
                  </div>
                  <div className="ios-progress" style={{ backgroundColor: '#48484A' }}>
                    <div style={{ backgroundColor: '#30D158', height: '4px', borderRadius: '2px', width: `${Math.min(Math.max(progressPercentage, 0), 100)}%`, transition: 'width 0.3s var(--ios-spring)' }} />
                  </div>
                </div>

                <div>
                  <div className="flex justify-between text-xs mb-1" style={{ color: '#8E8E93' }}>
                    <span>Strength</span>
                    <span className="tabular-nums">Push:{latestPushUps} Squat:{latestSplitSquats} Plank:{latestPlank}s Deep:{latestDeepSquat}s</span>
                  </div>
                  <div className="ios-progress" style={{ backgroundColor: '#48484A' }}>
                    <div style={{ backgroundColor: '#BF5AF2', height: '4px', borderRadius: '2px', width: `${Math.min(Math.max(strengthProgress, 0), 100)}%`, transition: 'width 0.3s var(--ios-spring)' }} />
                  </div>
                </div>

                <div>
                  <div className="flex justify-between text-xs mb-1" style={{ color: '#8E8E93' }}>
                    <span>Steps (weekly avg)</span>
                    <span className="tabular-nums">{weeklyStepsAverage.toLocaleString()} / {stepsGoal.toLocaleString()}</span>
                  </div>
                  <div className="ios-progress" style={{ backgroundColor: '#48484A' }}>
                    <div style={{ backgroundColor: '#FF9F0A', height: '4px', borderRadius: '2px', width: `${Math.min(Math.max(stepsProgress, 0), 100)}%`, transition: 'width 0.3s var(--ios-spring)' }} />
                  </div>
                </div>

                <div>
                  <div className="flex justify-between text-xs mb-1" style={{ color: '#8E8E93' }}>
                    <span>Workouts</span>
                    <span className="tabular-nums">{completedWorkouts} / {targetWorkouts}</span>
                  </div>
                  <div className="ios-progress" style={{ backgroundColor: '#48484A' }}>
                    <div style={{ backgroundColor: '#FFD60A', height: '4px', borderRadius: '2px', width: `${Math.min((completedWorkouts / targetWorkouts) * 100, 100)}%`, transition: 'width 0.3s var(--ios-spring)' }} />
                  </div>
                </div>
              </div>
            </div>
          </div>

          {/* Supplement Tracker */}
          <div style={{ padding: '0 16px', marginTop: '12px' }}>
            <div className="ios-card" style={{ padding: '12px 16px' }}>
              <div className="flex items-center gap-2 mb-2">
                <Pill className="w-4 h-4" style={{ color: '#FFD60A' }} />
                <span className="text-xs" style={{ color: '#8E8E93' }}>Daily supplements</span>
              </div>
              <div className="flex gap-3">
                <button
                  onClick={() => toggleSupplement('vitaminDAM')}
                  className="ios-btn flex-1 flex items-center justify-center gap-2 font-semibold text-sm"
                  style={{
                    padding: '10px',
                    borderRadius: '10px',
                    backgroundColor: supplements.vitaminDAM ? '#0A84FF' : '#2C2C2E',
                    color: supplements.vitaminDAM ? '#fff' : '#8E8E93',
                    minHeight: '44px'
                  }}
                >
                  {supplements.vitaminDAM && <Check className="w-4 h-4" />}
                  Vitamin D AM
                </button>
                <button
                  onClick={() => toggleSupplement('vitaminDPM')}
                  className="ios-btn flex-1 flex items-center justify-center gap-2 font-semibold text-sm"
                  style={{
                    padding: '10px',
                    borderRadius: '10px',
                    backgroundColor: supplements.vitaminDPM ? '#0A84FF' : '#2C2C2E',
                    color: supplements.vitaminDPM ? '#fff' : '#8E8E93',
                    minHeight: '44px'
                  }}
                >
                  {supplements.vitaminDPM && <Check className="w-4 h-4" />}
                  Vitamin D PM
                </button>
              </div>
            </div>
          </div>

          {(recommendedWorkout || needsTest) && (
            <div style={{ padding: '12px 16px 0' }}>
              {needsTest && (
                <div className="ios-card flex items-start gap-3" style={{ padding: '12px 16px', marginBottom: '8px', position: 'relative' }}>
                  <div style={{ position: 'absolute', top: '12px', right: '12px', width: '8px', height: '8px', borderRadius: '4px', backgroundColor: '#BF5AF2' }} />
                  <Bell className="w-5 h-5 flex-shrink-0 mt-0.5" style={{ color: '#BF5AF2' }} />
                  <div className="flex-1">
                    <p className="text-sm font-semibold" style={{ color: '#BF5AF2' }}>Monthly strength test</p>
                    <p className="text-xs mt-1" style={{ color: '#8E8E93' }}>Test your maxes to track progress</p>
                  </div>
                </div>
              )}
              {recommendedWorkout && !needsTest && (
                <div className="ios-card flex items-start gap-3" style={{ padding: '12px 16px', position: 'relative' }}>
                  <div style={{ position: 'absolute', top: '12px', right: '12px', width: '8px', height: '8px', borderRadius: '4px', backgroundColor: '#0A84FF' }} />
                  <Bell className="w-5 h-5 flex-shrink-0 mt-0.5" style={{ color: '#0A84FF' }} />
                  <div className="flex-1">
                    <p className="text-sm font-semibold" style={{ color: '#0A84FF' }}>Recommended today</p>
                    <p className="text-xs mt-1" style={{ color: '#8E8E93' }}>
                      {workoutTemplates[recommendedWorkout].name}
                    </p>
                  </div>
                </div>
              )}
            </div>
          )}

          <div className="grid grid-cols-3 gap-3" style={{ padding: '12px 16px' }}>
            <div className="col-span-2 ios-card" style={{ padding: '16px' }}>
              <div className="flex items-center gap-2 mb-2">
                <Target className="w-4 h-4" style={{ color: '#0A84FF' }} />
                <span className="text-xs" style={{ color: '#8E8E93' }}>Current weight</span>
              </div>
              <div className="flex items-center justify-center gap-2 mb-3 flex-wrap">
                <button
                  onClick={() => adjustWeight(-1)}
                  className="ios-btn"
                  style={{ padding: '8px 10px', backgroundColor: '#2C2C2E', borderRadius: '10px', minHeight: '36px' }}
                >
                  <span className="text-white text-sm font-semibold tabular-nums">-1</span>
                </button>
                <button
                  onClick={() => adjustWeight(-0.5)}
                  className="ios-btn"
                  style={{ padding: '8px 10px', backgroundColor: '#2C2C2E', borderRadius: '10px', minHeight: '36px' }}
                >
                  <span className="text-white text-xs font-semibold tabular-nums">-.5</span>
                </button>
                <input
                  type="number"
                  value={currentWeight}
                  onChange={(e) => setCurrentWeight(Number(e.target.value))}
                  className="text-xl font-bold w-16 text-white text-center tabular-nums"
                  style={{ backgroundColor: 'transparent', border: 'none', borderBottom: '2px solid #48484A' }}
                />
                <span className="text-sm" style={{ color: '#8E8E93' }}>lb</span>
                <button
                  onClick={() => adjustWeight(0.5)}
                  className="ios-btn"
                  style={{ padding: '8px 10px', backgroundColor: '#2C2C2E', borderRadius: '10px', minHeight: '36px' }}
                >
                  <span className="text-white text-xs font-semibold tabular-nums">+.5</span>
                </button>
                <button
                  onClick={() => adjustWeight(1)}
                  className="ios-btn"
                  style={{ padding: '8px 10px', backgroundColor: '#2C2C2E', borderRadius: '10px', minHeight: '36px' }}
                >
                  <span className="text-white text-sm font-semibold tabular-nums">+1</span>
                </button>
              </div>
              <div className="flex gap-2">
                <button
                  onClick={submitWeight}
                  className="ios-btn flex-1 flex items-center justify-center gap-1 font-semibold"
                  style={{ padding: '10px', backgroundColor: '#30D158', borderRadius: '12px', minHeight: '44px' }}
                  title="Log weight"
                >
                  <Check className="w-4 h-4 text-white" />
                  <span className="text-sm text-white">Log</span>
                </button>
                <button
                  onClick={() => setCurrentView('weightChart')}
                  className="ios-btn flex-1 flex items-center justify-center gap-1 font-semibold"
                  style={{ padding: '10px', backgroundColor: '#0A84FF', borderRadius: '12px', minHeight: '44px' }}
                >
                  <BarChart3 className="w-4 h-4 text-white" />
                  <span className="text-sm text-white">Chart</span>
                </button>
              </div>
            </div>

            <div className="col-span-1 ios-card" style={{ padding: '16px' }}>
              <div className="flex items-center gap-1 mb-2">
                <Footprints className="w-4 h-4" style={{ color: '#FF9F0A' }} />
                <span className="text-xs" style={{ color: '#8E8E93' }}>Steps</span>
              </div>
              <input
                type="number"
                value={currentSteps}
                onChange={(e) => setCurrentSteps(e.target.value)}
                placeholder="0"
                className="w-full text-lg font-bold text-white text-center tabular-nums mb-2"
                style={{ backgroundColor: 'transparent', border: 'none', borderBottom: '2px solid #48484A' }}
              />
              <div className="flex gap-1">
                <button
                  onClick={submitSteps}
                  className="ios-btn flex-1 flex items-center justify-center"
                  style={{ padding: '8px', backgroundColor: '#30D158', borderRadius: '10px', minHeight: '36px' }}
                  title="Log steps"
                >
                  <Check className="w-4 h-4 text-white" />
                </button>
                <button
                  onClick={() => setCurrentView('stepsChart')}
                  className="ios-btn flex-1 flex items-center justify-center"
                  style={{ padding: '8px', backgroundColor: '#FF9F0A', borderRadius: '10px', minHeight: '36px' }}
                >
                  <BarChart3 className="w-4 h-4 text-white" />
                </button>
              </div>
            </div>
          </div>

          <div style={{ padding: '24px 16px 12px' }}>
            <h2 className="font-semibold" style={{ fontSize: '22px', letterSpacing: '-0.3px', color: '#fff', marginBottom: '12px' }}>Start workout</h2>

            <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
              {needsTest && (
                <button
                  onClick={() => startWorkout('Strength-Test')}
                  className="ios-btn w-full text-left"
                  style={{ backgroundColor: '#1C1C1E', borderRadius: '16px', padding: '16px', position: 'relative' }}
                >
                  <div style={{ position: 'absolute', top: '12px', right: '12px', width: '8px', height: '8px', borderRadius: '4px', backgroundColor: '#BF5AF2' }} />
                  <div className="flex justify-between items-center">
                    <div>
                      <h3 className="font-semibold text-white" style={{ fontSize: '17px' }}>Strength Test (Monthly)</h3>
                      <p className="text-sm" style={{ color: '#BF5AF2' }}>Test your maxes</p>
                      <p className="text-xs mt-1 tabular-nums" style={{ color: '#48484A' }}>4 exercises &middot; ~20 min</p>
                    </div>
                    <ChevronRight className="w-5 h-5" style={{ color: '#BF5AF2' }} />
                  </div>
                </button>
              )}

              <button
                onClick={() => startWorkout('A')}
                className="ios-btn w-full text-left"
                style={{ backgroundColor: '#1C1C1E', borderRadius: '16px', padding: '16px', position: 'relative' }}
              >
                {recommendedWorkout === 'A' && (
                  <div style={{ position: 'absolute', top: '12px', right: '12px', width: '8px', height: '8px', borderRadius: '4px', backgroundColor: '#0A84FF' }} />
                )}
                <div className="flex justify-between items-center">
                  <div>
                    <h3 className="font-semibold text-white" style={{ fontSize: '17px' }}>Workout A - Strength</h3>
                    <p className="text-sm" style={{ color: '#8E8E93' }}>Mon / Fri</p>
                    <p className="text-xs mt-1 tabular-nums" style={{ color: '#48484A' }}>5 exercises &middot; ~45 min</p>
                  </div>
                  <ChevronRight className="w-5 h-5" style={{ color: recommendedWorkout === 'A' ? '#0A84FF' : '#48484A' }} />
                </div>
              </button>

              <button
                onClick={() => startWorkout('B')}
                className="ios-btn w-full text-left"
                style={{ backgroundColor: '#1C1C1E', borderRadius: '16px', padding: '16px', position: 'relative' }}
              >
                {recommendedWorkout === 'B' && (
                  <div style={{ position: 'absolute', top: '12px', right: '12px', width: '8px', height: '8px', borderRadius: '4px', backgroundColor: '#0A84FF' }} />
                )}
                <div className="flex justify-between items-center">
                  <div>
                    <h3 className="font-semibold text-white" style={{ fontSize: '17px' }}>Workout B - Volume + Legs</h3>
                    <p className="text-sm" style={{ color: '#8E8E93' }}>Wed</p>
                    <p className="text-xs mt-1 tabular-nums" style={{ color: '#48484A' }}>4 exercises &middot; ~45 min</p>
                  </div>
                  <ChevronRight className="w-5 h-5" style={{ color: recommendedWorkout === 'B' ? '#0A84FF' : '#48484A' }} />
                </div>
              </button>

              <button
                onClick={() => startWorkout('A-Progress')}
                className="ios-btn w-full text-left"
                style={{ backgroundColor: '#1C1C1E', borderRadius: '16px', padding: '16px', position: 'relative' }}
              >
                {recommendedWorkout === 'A-Progress' && (
                  <div style={{ position: 'absolute', top: '12px', right: '12px', width: '8px', height: '8px', borderRadius: '4px', backgroundColor: '#0A84FF' }} />
                )}
                <div className="flex justify-between items-center">
                  <div>
                    <h3 className="font-semibold text-white" style={{ fontSize: '17px' }}>Workout A - Progress Day</h3>
                    <p className="text-sm" style={{ color: '#8E8E93' }}>Fri (alternate)</p>
                    <p className="text-xs mt-1 tabular-nums" style={{ color: '#48484A' }}>5 exercises &middot; ~45 min</p>
                  </div>
                  <ChevronRight className="w-5 h-5" style={{ color: recommendedWorkout === 'A-Progress' ? '#0A84FF' : '#48484A' }} />
                </div>
              </button>
            </div>
          </div>

          <div style={{ padding: '12px 16px 24px' }}>
            <div className="ios-card" style={{ overflow: 'hidden', marginBottom: '12px' }}>
              <button
                onClick={() => setCurrentView('history')}
                className="ios-btn w-full flex items-center gap-3"
                style={{ padding: '12px 16px', minHeight: '44px', borderBottom: '1px solid rgba(60,60,67,0.36)' }}
              >
                <Calendar className="w-5 h-5" style={{ color: '#8E8E93' }} />
                <span className="font-semibold text-white flex-1 text-left" style={{ fontSize: '17px' }}>History</span>
                <ChevronRight className="w-5 h-5" style={{ color: '#48484A' }} />
              </button>

              <button
                onClick={() => setCurrentView('notes')}
                className="ios-btn w-full flex items-center gap-3"
                style={{ padding: '12px 16px', minHeight: '44px' }}
              >
                <FileText className="w-5 h-5" style={{ color: '#8E8E93' }} />
                <span className="font-semibold text-white flex-1 text-left" style={{ fontSize: '17px' }}>Notes</span>
                <ChevronRight className="w-5 h-5" style={{ color: '#48484A' }} />
              </button>
            </div>

            <div className="grid grid-cols-2 gap-3">
              <button
                onClick={exportData}
                className="ios-btn ios-card flex items-center justify-center gap-2"
                style={{ padding: '14px', minHeight: '44px' }}
              >
                <Download className="w-5 h-5" style={{ color: '#30D158' }} />
                <span className="font-semibold text-white text-sm">Export</span>
              </button>

              <button
                onClick={() => fileInputRef.current?.click()}
                className="ios-btn ios-card flex items-center justify-center gap-2"
                style={{ padding: '14px', minHeight: '44px' }}
              >
                <Upload className="w-5 h-5" style={{ color: '#0A84FF' }} />
                <span className="font-semibold text-white text-sm">Import</span>
              </button>

              <input
                ref={fileInputRef}
                type="file"
                accept=".json"
                onChange={importData}
                style={{ display: 'none' }}
              />
            </div>
          </div>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<WorkoutTracker />);
  </script>
</body>
</html>
